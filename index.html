<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no" />
  <title>ซื้อแปรงรองพื้น M-BLITHE ขนแน่นนุ่ม เกลี่ยเนียน ไม่กินรองพื้น ส่งฟรี เก็บเงินปลายทาง</title>
  <meta name="description" content="แปรงรองพื้น M-BLITHE ขนแน่น นุ่ม เกลี่ยง่าย ไม่กินรองพื้น รีวิวจริงจากลูกค้าหลายพันคน ส่งฟรี เก็บเงินปลายทาง เหมาะสำหรับมือใหม่และมืออาชีพ">
  <meta name="keywords" content="แปรงรองพื้น, แปรงแต่งหน้า, M-BLITHE, เกลี่ยรองพื้น, ขนนุ่ม, ขนแน่น, ส่งฟรี, เก็บเงินปลายทาง">
  <link rel="canonical" href="https://tuowzz.github.io/mbshopz.github.io/brush" />

  <meta property="og:title" content="ซื้อแปรงรองพื้น M-BLITHE ขนแน่นนุ่ม เกลี่ยเนียน ไม่กินรองพื้น ส่งฟรี เก็บเงินปลายทาง" />
  <meta property="og:description" content="แปรงรองพื้น M-BLITHE ขนแน่น นุ่ม เกลี่ยง่าย ไม่กินรองพื้น รีวิวจริงหลายพัน ส่งฟรี เก็บเงินปลายทาง #แปรงรองพื้น #mblithe" />
  <meta property="og:image" content="https://tuowzz.github.io/mbshopz.github.io/brush_photo.jpg" />
  <meta property="og:url" content="https://tuowzz.github.io/mbshopz.github.io/brush" />
  <meta property="og:type" content="product" />

  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:title" content="ซื้อแปรงรองพื้น M-BLITHE ขนแน่นนุ่ม เกลี่ยเนียน ไม่กินรองพื้น ส่งฟรี เก็บเงินปลายทาง">
  <meta name="twitter:description" content="แปรงรองพื้น M-BLITHE ขนแน่น นุ่ม เกลี่ยง่าย ไม่กินรองพื้น รีวิวจริงหลายพัน ส่งฟรี เก็บเงินปลายทาง">
  <meta name="twitter:image" content="https://tuowzz.github.io/mbshopz.github.io/brush_photo.jpg">

  <!-- Google Ads Pixel (gtag.js) -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=AW-17035064059"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'AW-17035064059');
  </script>

  <script type="application/ld+json">
  {
    "@context": "https://schema.org/",
    "@type": "Product",
    "name": "M-BLITHE แปรงรองพื้น",
    "image": "https://tuowzz.github.io/mbshopz.github.io/brush_photo.jpg",
    "description": "แปรงรองพื้น M-BLITHE ขนแน่น นุ่ม เกลี่ยง่าย ไม่กินรองพื้น รีวิวจริงจากลูกค้าหลายพัน ส่งฟรี เก็บเงินปลายทาง",
    "brand": { "@type": "Brand", "name": "M-BLITHE" },
    "offers": {
      "@type": "Offer",
      "price": "199",
      "priceCurrency": "THB",
      "availability": "https://schema.org/InStock",
      "url": "https://tuowzz.github.io/mbshopz.github.io/brush"
    },
    "aggregateRating": {
      "@type": "AggregateRating",
      "ratingValue": "4.9",
      "reviewCount": "8000"
    }
  }
  </script>

  <!-- Facebook Pixel -->
  <script>
    !function(f,b,e,v,n,t,s)
    {if(f.fbq)return;n=f.fbq=function(){n.callMethod?
    n.callMethod.apply(n,arguments):n.queue.push(arguments)};
    if(!f._fbq)f._fbq=n;n.push=n;n.loaded=!0;n.version='2.0';
    n.queue=[];t=b.createElement(e);t.async=!0;
    t.src=v;s=b.getElementsByTagName(e)[0];
    s.parentNode.insertBefore(t,s)}(window, document,'script',
    'https://connect.facebook.net/en_US/fbevents.js');
    fbq('init', '127978927946856');
    fbq('track', 'PageView');
    fbq('track', 'ViewContent');
  </script>
  <noscript><img height="1" width="1" style="display:none"
    src="https://www.facebook.com/tr?id=127978927946856&ev=PageView&noscript=1"
  /></noscript>

  <!-- TikTok Pixel -->
  <script>
  !function (w, d, t) {
    w.TiktokAnalyticsObject = t;
    var ttq = w[t] = w[t] || [];
    ttq.methods = ["page","track","identify","instances","debug","on","off","once","ready","alias","group","enableCookie"];
    ttq.setAndDefer = function (t, e) { t[e] = function () { t.push([e].concat(Array.prototype.slice.call(arguments, 0))) } };
    for (var i = 0; i < ttq.methods.length; i++) { ttq.setAndDefer(ttq, ttq.methods[i]) }
    ttq.instance = function (t) { for (var e = ttq._i[t] || [], n = 0; n < ttq.methods.length; n++) { ttq.setAndDefer(e, ttq.methods[n]) } return e };
    ttq.load = function (e, n) {
      var i = "https://analytics.tiktok.com/i18n/pixel/events.js";
      ttq._i = ttq._i || {};
      ttq._i[e] = [];
      ttq._i[e]._u = i;
      ttq._t = ttq._t || {};
      ttq._t[e] = +new Date;
      ttq._o = ttq._o || {};
      ttq._o[e] = n || {};
      var o = document.createElement("script");
      o.type = "text/javascript";
      o.async = !0;
      o.src = i + "?sdkid=" + e + "&lib=" + t;
      var a = document.getElementsByTagName("script")[0];
      a.parentNode.insertBefore(o, a)
    };
    ttq.load('D0EVS2JC77U9C23772EG');
    ttq.page();
  }(window, document, 'ttq');
  </script>

  <link href="https://fonts.googleapis.com/css2?family=Kanit:wght@400;500;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css">
  <style>
    /* ... style เดิมทั้งหมดของคุณ ... */
  </style>
</head>
<body>

  <!-- ... HTML เดิมของคุณ ... -->

  <script>
    const GOOGLE_SHEET_WEB_APP_URL = 'https://script.google.com/macros/s/AKfycbxvkT44c1V26IyzQW_4FhR4iQ0gmrNvdhF5TnneqNZ-21JXFczyZBo-8EFzhA69WshT/exec';

    // ยิง ViewContent TikTok Pixel ตอนโหลดหน้า
    if (window.ttq) ttq.track('ViewContent');

    // Modal variables
    const buyNowModal = document.getElementById('buyNowModal');
    const closeModalBtn = document.getElementById('closeModalBtn');
    const buyNowBtn = document.getElementById('buyNowBtn');

    // Modal control
    function openModal() { 
      buyNowModal.style.display = 'flex';
      trackInitiateCheckout();
    }
    function closeModal() { buyNowModal.style.display = 'none'; }
    buyNowBtn.addEventListener('click', openModal);
    closeModalBtn.addEventListener('click', closeModal);
    buyNowModal.addEventListener('click', (event) => {
      if (event.target === buyNowModal) { closeModal(); }
    });

    // LINE Button Tracking (Header + Footer)
    function lineTrackingHandler() {
      // --- PIXEL ---
      if(window.fbq) fbq('track', 'Contact');
      if(window.ttq) ttq.track('Contact');
    }
    document.querySelectorAll('#addLineBtn, #addLineBtnFooter').forEach(el => {
      if(el) el.addEventListener('click', lineTrackingHandler);
    });

    // InitiateCheckout Tracking
    function trackInitiateCheckout() {
      if(window.fbq) fbq('track', 'InitiateCheckout');
      if(window.ttq) ttq.track('InitiateCheckout');
    }

    // Form submit
    function sendOrderToSheet(event) {
      event.preventDefault();
      const orderForm = document.getElementById('orderForm');
      const submitButton = document.getElementById('submitBtn');
      const originalButtonText = submitButton.textContent;
      submitButton.disabled = true;
      submitButton.textContent = 'กำลังส่งข้อมูล...';
      const formData = new FormData(orderForm);
      const phoneField = orderForm.querySelector('#phone');
      if (phoneField && phoneField.value && !phoneField.value.startsWith("'")) {
        formData.set('phone', "'" + phoneField.value);
      }
      formData.set("order_id", 'ORD-' + Date.now());
      fetch(GOOGLE_SHEET_WEB_APP_URL, {
        method: "POST", body: formData
      })
      .then(response => response.json())
      .then(data => {
        submitButton.disabled = false;
        submitButton.textContent = originalButtonText;
        if (data.result === 'success') {
          // --- PIXEL: PURCHASE EVENT ---
          if(window.fbq) fbq('track', 'Purchase', {value: 199.00, currency: 'THB'});
          if(window.ttq) ttq.track('CompletePayment', {
            contents: [{content_id:'MB-BRUSH',content_type:'product',quantity:1}],
            value: 199.00,
            currency: 'THB'
          });
          if(window.gtag) {
            gtag('event', 'conversion', {
              'send_to': 'AW-17035064059/53zPCNHE2OIaEPvl-bo_',
              'value': 199.00,
              'currency': 'THB'
            });
          }
          closeModal();
          orderForm.reset();
          const successPopup = document.getElementById('successPopup');
          successPopup.style.display = 'block';
          setTimeout(() => { successPopup.style.display = 'none'; }, 2800);
        } else {
          alert('เกิดข้อผิดพลาด: ' + (data.message || 'ไม่ทราบสาเหตุ'));
        }
      })
      .catch(err => {
        submitButton.disabled = false;
        submitButton.textContent = originalButtonText;
        alert("เกิดข้อผิดพลาดในการส่งข้อมูล: " + err.message);
        console.error("Fetch Error:", err);
      });
    }
  </script>
</body>
</html>
